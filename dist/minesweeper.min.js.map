{"version":3,"sources":["minesweeper.min.js"],"names":["angular","module","MinesweeperService","this","reset","service","$inject","MinesweeperController","$scope","DEFAULT_COLS","DEFAULT_ROWS","MAX_COLS","MAX_ROWS","$watch","minePercent","get","cols","rows","buildBoard","cells","cellCount","i","cell","hasFlag","hasMine","Math","random","isUnknown","col","row","floor","j","k","touches","countTouches","click","alpha","beta","value","init","controller","directive","controllerAs","restrict","scope","template"],"mappings":"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","file":"minesweeper.min.js","sourcesContent":["(function() {\n    'use strict';\n\n    angular.module('minesweeper', []);\n})();\n(function() {\n    'use strict';\n\n    angular.module('minesweeper').service(\n        'MinesweeperService',\n        MinesweeperService\n    );\n\n    MinesweeperService.$inject = [];\n\n    function MinesweeperService() {\n        var MinesweeperService = this;\n\n        MinesweeperService.reset = reset;\n        function reset() {\n\n        }\n        \n        MinesweeperService.reset();\n\n        return MinesweeperService;\n    }\n})();\n(function() {\n    'use strict';\n\n    angular.module('minesweeper').controller(\n        'MinesweeperController',\n        MinesweeperController\n    );\n\n    MinesweeperController.$inject = [\n        '$scope',\n        'MinesweeperService'\n    ];\n\n    function MinesweeperController(\n        $scope,\n        MinesweeperService\n    ) {\n        var MinesweeperController = this;\n\n        MinesweeperController.DEFAULT_COLS = 5;\n        MinesweeperController.DEFAULT_ROWS = 5;\n\n        MinesweeperController.MAX_COLS = 144;\n        MinesweeperController.MAX_ROWS = 144;\n\n        $scope.$watch(\n            'minePercent',\n            function(minePercent) {\n                MinesweeperController.minePercent = MinesweeperController.get(\n                    minePercent,\n                    0.15\n                );\n            }\n        );\n\n        $scope.$watch(\n            'cols',\n            function(cols) {\n                MinesweeperController.cols = MinesweeperController.get(\n                    cols,\n                    MinesweeperController.DEFAULT_COLS\n                );\n\n                if (MinesweeperController.cols > MinesweeperController.MAX_COLS) {\n                    MinesweeperController.cols = MinesweeperController.MAX_COLS;\n                }\n            }\n        );\n\n        $scope.$watch(\n            'rows',\n            function(rows) {\n                MinesweeperController.rows = MinesweeperController.get(\n                    rows,\n                    MinesweeperController.DEFAULT_ROWS\n                );\n\n                if (MinesweeperController.cols > MinesweeperController.MAX_ROWS) {\n                    MinesweeperController.cols = MinesweeperController.MAX_ROWS;\n                }\n\n                MinesweeperController.buildBoard();\n            }\n        );\n\n        MinesweeperController.buildBoard = buildBoard;\n        function buildBoard() {\n            MinesweeperController.cells = [];\n\n            MinesweeperController.cellCount = MinesweeperController.cols * MinesweeperController.rows;\n            for (var i = 0; i < MinesweeperController.cellCount; i++) {\n                var cell = {};\n\n                cell.hasFlag = false;\n                cell.hasMine = Math.random() <= MinesweeperController.minePercent;\n                cell.isUnknown = true;\n\n                var col = i % MinesweeperController.cols;\n                var row = Math.floor(i / MinesweeperController.cols);\n\n                cell.col = col;\n                cell.row = row;\n\n                if (col === 0) {\n                    MinesweeperController.cells[row] = [];\n                }\n\n                MinesweeperController.cells[row][col] = cell;\n            }\n\n            for (var j = 0; j < MinesweeperController.rows; j++) {\n                for (var k = 0; k < MinesweeperController.cols; k++) {\n                    MinesweeperController.cells[j][k].touches = MinesweeperController.countTouches(\n                        MinesweeperController.cells[j][k]\n                    );\n                }\n            }\n        }\n\n        MinesweeperController.click = click;\n        function click(cell) {\n            cell.isUnknown = false;\n        }\n\n        MinesweeperController.countTouches = countTouches;\n        function countTouches(cell) {\n            var col = cell.col;\n            var row = cell.row;\n\n            var touches = 0;\n            if (col !== 0 && MinesweeperController.cells[row][col - 1].hasMine) { // LEFT\n                touches++;\n            }\n            if (col + 1 !== MinesweeperController.cols && MinesweeperController.cells[row][col + 1].hasMine) { // RIGHT\n                touches++;\n            }\n            if (row !== 0 && MinesweeperController.cells[row - 1][col].hasMine) { // TOP\n                touches++;\n            }\n            if (row + 1 !== MinesweeperController.rows && MinesweeperController.cells[row + 1][col].hasMine) { // BOTTOM\n                touches++;\n            }\n            if (col !== 0 && row + 1 !== MinesweeperController.rows && MinesweeperController.cells[row + 1][col - 1].hasMine) { // BOTTOM LEFT\n                touches++;\n            }\n            if (col + 1 !== MinesweeperController.cols && row + 1 !== MinesweeperController.rows && MinesweeperController.cells[row + 1][col + 1].hasMine) { // BOTTOM RIGHT\n                touches++;\n            }\n            if (col !== 0 && row !== 0 && MinesweeperController.cells[row - 1][col - 1].hasMine) { // TOP LEFT\n                touches++;\n            }\n            if (col + 1 !== MinesweeperController.cols && row !== 0 && MinesweeperController.cells[row - 1][col + 1].hasMine) { // TOP RIGHT\n                touches++;\n            }\n\n            return touches;\n        }\n        \n        MinesweeperController.get = get;\n        function get(alpha, beta) {\n            var value = null;\n            \n            if (typeof alpha === 'undefined') {\n                if (typeof beta !== 'undefined') {\n                    value = beta;\n                }\n            }\n\n            return value;\n        }\n\n        MinesweeperController.reset = reset;\n        function reset() {\n\n        }\n\n        MinesweeperController.init = init;\n        function init() {\n            MinesweeperController.reset();\n        }\n\n        MinesweeperController.init();\n    }\n})();\n(function() {\n    'use strict';\n\n    angular.module('minesweeper').directive(\n        'minesweeper',\n        minesweeper\n    );\n\n    function minesweeper() {\n        return {\n            controller:   'MinesweeperController',\n            controllerAs: 'ctrl',\n            restrict:     'E',\n            scope:        {\n                cols:        '=',\n                minePercent: '=',\n                rows:        '='\n            },\n            template:'<div class=\"row\" data-ng-repeat=\"cols in ctrl.cells\"><div data-ng-repeat=\"cell in cols\" class=\"col cell\" data-ng-class=\"{ \\'clear\\': !cell.isUnknown && !cell.hasMine && cell.touches === 0, \\'mine\\': !cell.isUnknown && cell.hasMine, \\'safe\\': !cell.isUnknown && !cell.hasMine && cell.touches !== 0, \\'flag\\': cell.isUnknown && cell.hasFlag, \\'unknown\\': cell.isUnknown && !cell.hasFlag, \\'touches-0\\': cell.touches === 0, \\'touches-1\\': cell.touches === 1, \\'touches-2\\': cell.touches === 2, \\'touches-3\\': cell.touches === 3, \\'touches-4\\': cell.touches === 4, \\'touches-5\\': cell.touches === 5, \\'touches-6\\': cell.touches === 6, \\'touches-7\\': cell.touches === 7, \\'touches-8\\': cell.touches === 8 }\" data-ng-click=\"ctrl.click(cell)\">{{ cell.hasMine ? \\'X\\' : cell.touches }}</div></div>'\n        };\n    }\n})();"]}