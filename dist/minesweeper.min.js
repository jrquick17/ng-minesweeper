!function(){"use strict";angular.module("minesweeper",[])}(),function(){"use strict";function e(){var e=this;return e.reset=function(){},e.reset(),e}angular.module("minesweeper").service("MinesweeperService",e),e.$inject=[]}(),function(){"use strict";function e(e,t){var n=this;n.DEFAULT_COLS=10,n.DEFAULT_ROWS=6,n.MIN_COLS=3,n.MIN_ROWS=3,n.MAX_COLS=48,n.MAX_ROWS=48,n.mineCount=0,e.$watch("minePercent",function(e){n.minePercent=n.get(e,.12)}),e.$watch("cols",function(e){n.cols=n.get(e,n.DEFAULT_COLS)}),e.$watch("rows",function(e){n.rows=n.get(e,n.DEFAULT_ROWS),n.buildBoard()}),e.$watch("unlimitedFlags",function(e){n.unlimitedFlags=n.get(e,!1)}),n.buildBoard=function(){n.checkColsAndRows(),n.cells=[];for(var e=0;e<n.rows;e++){n.cells[e]=[];for(var t=0;t<n.cols;t++){var l={hasFlag:!1};l.hasMine=Math.random()<=n.minePercent,l.hasMine&&n.mineCount++,l.isClear=!1,l.col=t,l.row=e,n.cells[e][t]=l}}for(var o=0;o<n.rows;o++)for(var s=0;s<n.cols;s++)n.cells[o][s].touches=n.countTouches(n.cells[o][s])},n.checkColsAndRows=function(){n.cols>n.MAX_COLS?n.cols=n.MAX_COLS:n.cols<n.MIN_COLS&&(n.cols=n.MIN_COLS);n.rows>n.MAX_ROWS?n.rows=n.MAX_ROWS:n.rows<n.MIN_ROWS&&(n.rows=n.MIN_ROWS)},n.checkEnd=function(){for(var e=0;e<n.rows;e++)for(var t=0;t<n.cols;t++)if(!n.cells[e][t].isClear){if(!n.cells[e][t].hasFlag)return!1;if(!n.cells[e][t].hasMine)return!1}return!0},n.clearNeighbors=function(e){for(var t=n.getNeighbors(e),l=t.length,o=0;o<l;o++){var s=t[o];s.isClear||s.hasMine||n.clearCell(s)}},n.clearCell=function(e){e.hasFlag||(e.isClear=!0,e.hasMine?(n.showMessage("BOOM!","Game Over"),n.gameover=!0):0===e.touches&&n.clearNeighbors(e))},n.click=function(e,t){if(!n.gameover){1===e.which?n.clearCell(t):3===e.which&&n.setFlag(t);var l=n.checkEnd();l&&(n.showMessage("Good game.","Game Over"),n.gameover=!0)}},n.closeModal=function(){$("#modal").modal("hide")},n.countTouches=function(e){for(var t=0,l=n.getNeighbors(e),o=l.length,s=0;s<o;s++){var c=l[s];c.hasMine&&t++}return t},n.get=function(e,t){var l=null;void 0===e&&void 0!==t&&(l=t);return l},n.getNeighbors=function(e){for(var t=[],l=["getNeighborBottom","getNeighborBottomLeft","getNeighborBottomRight","getNeighborLeft","getNeighborRight","getNeighborTop","getNeighborTopLeft","getNeighborTopRight"],o=l.length,s=0;s<o;s++){var c=l[s],r=n[c](e);null!==r&&t.push(r)}return t},n.getNeighborBottom=function(e){if(e.row+1!==n.rows)return n.cells[e.row+1][e.col];return null},n.getNeighborBottomLeft=function(e){if(0!==e.col&&e.row+1!==n.rows)return n.cells[e.row+1][e.col-1];return null},n.getNeighborBottomRight=function(e){if(e.col+1!==n.cols&&e.row+1!==n.rows)return n.cells[e.row+1][e.col+1];return null},n.getNeighborLeft=function(e){if(0!==e.col)return n.cells[e.row][e.col-1];return null},n.getNeighborRight=function(e){if(e.col+1!==n.cols)return n.cells[e.row][e.col+1];return null},n.getNeighborTop=function(e){if(0!==e.row)return n.cells[e.row-1][e.col];return null},n.getNeighborTopLeft=function(e){if(0!==e.col&&0!==e.row)return n.cells[e.row-1][e.col-1];return null},n.getNeighborTopRight=function(e){if(e.col+1!==n.cols&&0!==e.row)return n.cells[e.row-1][e.col+1];return null},n.restart=function(){n.reset(),n.buildBoard()},n.setFlag=function(e){n.unlimitedFlags||n.flagsUsed<n.mineCount?e.isClear||(e.hasFlag?(e.hasFlag=!1,n.flagsUsed--):(e.hasFlag=!0,n.flagsUsed++)):n.showMessage("No more flags left.")},n.showMessage=function(e,t){n.message=e,n.title=n.get(t,"Message"),$("#modal").modal("show")},n.toggleSettings=function(){n.showSettings=!n.showSettings},n.reset=function(){n.flagsUsed=0,n.gameover=!1,n.message="",n.mustRestart=!1,n.showSettings=!1,n.title=""},n.init=function(){n.reset()},n.init()}angular.module("minesweeper").controller("MinesweeperController",e),e.$inject=["$scope","MinesweeperService"]}(),function(){"use strict";angular.module("minesweeper").directive("minesweeper",function(){return{controller:"MinesweeperController",controllerAs:"ctrl",restrict:"E",scope:{cols:"=",minePercent:"=",rows:"=",unlimitedFlags:"="},template:'<div class="global-wrapper"><div class="row title-bar"><div class="col"><button data-ng-if="ctrl.gameover" type="button" class="btn btn-default btn-sm float-left" data-ng-click="ctrl.restart()"><img src="node_modules/octicons/build/svg/triangle-right.svg"> PLAY AGAIN</button> <button data-ng-if="!ctrl.gameover" type="button" class="btn btn-default btn-sm float-left" data-ng-click="ctrl.restart()"><img src="node_modules/octicons/build/svg/sync.svg"> RESET</button></div><div class="col text-center">{{ ctrl.showSettings ? \'SETTINGS\' : \'MINESWEEPER\' }}</div><div class="col"><button type="button" class="btn btn-default btn-sm float-right" data-ng-click="ctrl.toggleSettings()"><img src="node_modules/octicons/build/svg/gear.svg"> SETTINGS</button></div></div><div class="board"><div data-ng-if="!ctrl.showSettings" class="row no-gutters" data-ng-class="{ \'gameover\': ctrl.gameover }" data-ng-repeat="cols in ctrl.cells"><div data-ng-repeat="cell in cols" class="col" data-ng-class="{ \'clear\': cell.isClear && !cell.hasMine && cell.touches === 0, \'mine\': cell.isClear && cell.hasMine, \'safe\': cell.isClear && !cell.hasMine && cell.touches !== 0, \'flag\': !cell.isClear && cell.hasFlag, \'unknown\': !cell.isClear && !cell.hasFlag, \'touches-0\': cell.touches === 0, \'touches-1\': cell.touches === 1, \'touches-2\': cell.touches === 2, \'touches-3\': cell.touches === 3, \'touches-4\': cell.touches === 4, \'touches-5\': cell.touches === 5, \'touches-6\': cell.touches === 6, \'touches-7\': cell.touches === 7, \'touches-8\': cell.touches === 8 }" data-ng-mousedown="ctrl.click($event, cell)" oncontextmenu="return false"><div class="dummy"></div><div class="cell"><div data-ng-if="cell.isClear">{{ cell.hasMine ? \'X\' : cell.touches }}</div></div></div></div></div><div data-ng-if="ctrl.showSettings"><div class="row"><div class="col-72 form-group"><label>Rows <input type="text" class="form-control" min="ctrl.MAX_ROWS" max="ctrl.MIN_ROWS" step="1" data-ng-model="ctrl.rows" data-ng-change="ctrl.mustRestart = true"></label></div><div class="col-72 form-group"><label>Columns <input type="number" class="form-control" min="ctrl.MAX_COLS" max="ctrl.MIN_COLS" step="1" data-ng-model="ctrl.cols" data-ng-change="ctrl.mustRestart = true"></label></div></div><div class="row"><div class="col form-group"><label>Mine Percent <input type="number" class="form-control" min="0.01" max="1.00" step="0.01" data-ng-model="ctrl.minePercent" data-ng-change="ctrl.mustRestart = true"></label></div></div><div class="row"><div class="col input-group"><div class="input-group-prepend"><div class="input-group-text"><input type="radio" aria-label="Unlimited flags" data-ng-model="ctrl.unlimitedFlags" data-ng-change="ctrl.mustRestart = true"> Unlimited Flags</div></div></div></div><div class="row"><button data-ng-if="ctrl.mustRestart" class="btn btn-block col-72" data-ng-click="ctrl.init()">Save and Restart</button> <button class="btn btn-block" data-ng-class="{ \'col-72\': ctrl.mustRestart }" data-ng-click="ctrl.toggleSettings()">Cancel</button></div></div></div><div id="modal" class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">{{ ctrl.title }}</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body">{{ ctrl.message }}</div><div class="modal-footer"><button type="button" class="btn btn-primary btn-block" data-ng-click="ctrl.closeModal()">Close</button></div></div></div></div>'}})}();
//# sourceMappingURL=minesweeper.min.js.map
